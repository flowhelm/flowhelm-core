services:
  flowhelm-gateway:
    build:
      context: .
      dockerfile: Dockerfile
    image: flowhelm-core:local
    container_name: flowhelm-gateway
    restart: unless-stopped
    environment:
      HOME: /home/node
      TERM: xterm-256color
      OPENCLAW_GATEWAY_BIND: ${OPENCLAW_GATEWAY_BIND:-lan}
    volumes:
      - ${OPENCLAW_CONFIG_DIR:-./.flowhelm-config}:/home/node/.openclaw
      - ${OPENCLAW_WORKSPACE_DIR:-./.flowhelm-workspace}:/home/node/.openclaw/workspace
    ports:
      - "${OPENCLAW_GATEWAY_PORT:-18789}:18789"
      - "${OPENCLAW_BRIDGE_PORT:-18790}:18790"
    command:
      [
        "node",
        "dist/index.js",
        "gateway",
        "--allow-unconfigured",
        "--bind",
        "${OPENCLAW_GATEWAY_BIND:-lan}",
        "--port",
        "18789",
      ]

  ollama:
    image: ollama/ollama:latest
    container_name: flowhelm-ollama
    restart: unless-stopped
    ports:
      - "11434:11434"
    volumes:
      - ollama-data:/root/.ollama

volumes:
  ollama-data:
